/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com

  v0.4.7

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/shifty/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(c){function a(){return+new Date}function b(a,d){for(var g in a)a.hasOwnProperty(g)&&d(a,g)}function i(a,d){b(d,function(d,h){a[h]=d[h]});return a}function l(a,d){b(d,function(d,h){typeof a[h]==="undefined"&&(a[h]=d[h])});return a}function k(a,d,g){var h,a=(a-d.timestamp)/d.duration;for(h in g.current)g.current.hasOwnProperty(h)&&d.to.hasOwnProperty(h)&&(g.current[h]=d.originalState[h]+(d.to[h]-d.originalState[h])*d.easingFunc(a));return g.current}function j(a,d,g,h){var c;for(c=0;c<d[a].length;c++)d[a][c].apply(g,
h)}function m(a,d,g){b(c.Tweenable.prototype.filter,function(h,c){h[c][a]&&h[c][a].apply(d,g)})}function n(e,d){var g;g=a();g<e.timestamp+e.duration&&d.isAnimating?(d.loopId=setTimeout(function(){n(e,d)},1E3/e.owner.fps),m("beforeTween",e.owner,[d.current,e.originalState,e.to]),k(g,e,d),m("afterTween",e.owner,[d.current,e.originalState,e.to]),e.hook.step&&j("step",e.hook,e.owner,[d.current]),e.step.call(d.current)):e.owner.stop(!0)}function f(a){a=a||{};this._hook={};this._tweenParams={owner:this,
hook:this._hook,data:{}};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this}f.prototype.tween=function(e,d,g,h,c){var b,f;if(!this._state.isAnimating)return b=this._tweenParams,f=this._state,this._state.loopId=0,this._state.pausedAtTime=null,d?(b.step=function(){},b.to=d||{},b.duration=g||this.duration,b.callback=h||function(){},b.easing=c||this.easing,f.current=e||{}):(b.step=e.step||function(){},b.callback=
e.callback||function(){},b.to=e.to||e.target||{},b.duration=e.duration||this.duration,b.easing=e.easing||this.easing,f.current=e.from||{}),b.timestamp=a(),b.easingFunc=this.formula[b.easing]||this.formula.linear,l(f.current,b.to),l(b.to,f.current),m("tweenCreated",b.owner,[f.current,b.originalState,b.to]),b.originalState=i({},f.current),f.isAnimating=!0,this.resume(),e.start&&e.start(),this};f.prototype.to=function(a,d,g,h){typeof d==="undefined"?(a.from=this.get(),this.tween(a)):this.tween(this.get(),
a,d,g,h);return this};f.prototype.get=function(){return this._state.current};f.prototype.set=function(a){this._state.current=a||{};return this};f.prototype.stop=function(a){clearTimeout(this._state.loopId);this._state.isAnimating=!1;a&&(i(this._state.current,this._tweenParams.to),m("afterTweenEnd",this,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.callback.call(this._state.current));return this};f.prototype.pause=function(){clearTimeout(this._state.loopId);
this._state.pausedAtTime=a();this._state.isPaused=!0;return this};f.prototype.resume=function(){this._state.isPaused&&(this._tweenParams.timestamp+=a()-this._state.pausedAtTime);n(this._tweenParams,this._state);return this};f.prototype.hookAdd=function(a,d){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(d)};f.prototype.hookRemove=function(a,d){var g;if(this._hook.hasOwnProperty(a))if(d)for(g=this._hook[a].length;g>=0;g++)this._hook[a][g]===d&&this._hook[a].splice(g,1);else this._hook[a]=
[]};f.prototype.filter={};f.util={now:a,each:b,tweenProps:k,applyFilter:m,simpleCopy:i,weakCopy:l};f.prototype.formula={linear:function(a){return a}};if(typeof c.Tweenable==="undefined")c.Tweenable=f})(this);
(function(c){c.Tweenable.util.simpleCopy(c.Tweenable.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=0.5)<1?0.5*Math.pow(a,2):-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=0.5)<1?0.5*Math.pow(a,3):0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){return(a/=0.5)<1?0.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=0.5)<1?0.5*Math.pow(a,5):0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==0?0:Math.pow(2,
10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return a==0?0:a==1?1:(a/=0.5)<1?0.5*Math.pow(2,10*(a-1)):0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=0.5)<1?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*
(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;return(a/=0.5)<1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},
swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*a+0.984375)},easeFromTo:function(a){return(a/=0.5)<1?0.5*Math.pow(a,
4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}})})(this);
(function(c){function a(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function b(a,b,c,j,m,n){return function(){c?a.tween(b,c,j,m,n):(b.callback=m,b.from?a.tween(b):a.to(b))}}c.Tweenable.prototype.queue=function(c,l,k,j,m){if(!this._tweenQueue)this._tweenQueue=[];j=j||c.callback||function(){};j=a(j,this._tweenQueue);this._tweenQueue.push(b(this,c,l,k,j,m));return this};c.Tweenable.prototype.queueStart=function(){if(!this._tweenQueue.running&&this._tweenQueue.length>0)this._tweenQueue[0](),
this._tweenQueue.running=!0;return this};c.Tweenable.prototype.queueShift=function(){this._tweenQueue.shift();return this};c.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this};c.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};c.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(c){function a(a){return parseInt(a,16)}function b(b){c.Tweenable.util.each(b,function(d,b){if(typeof d[b]==="string"&&(j.test(d[b])||m.test(d[b]))){var e;e=d[b];e=e.replace(/#/g,"");e.length===3&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);e=[a(e.substr(0,2)),a(e.substr(2,2)),a(e.substr(4,2))];d[b]="rgb("+e[0]+","+e[1]+","+e[2]+")"}})}function i(a){var d;d=[];c.Tweenable.util.each(a,function(a,e){typeof a[e]==="string"&&(j.test(a[e])||m.test(a[e])||n.test(a[e]))&&d.push(e)});return d}
function l(a,d){var b,c,f;c=d.length;for(b=0;b<c;b++)f=a[d[b]].match(/(\d+)/g),a["__r__"+d[b]]=+f[0],a["__g__"+d[b]]=+f[1],a["__b__"+d[b]]=+f[2],delete a[d[b]]}function k(a,b){var c,f;f=b.length;for(c=0;c<f;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var j=/^#([0-9]|[a-f]){3}$/i,m=/^#([0-9]|[a-f]){6}$/i,n=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,f;if(c.Tweenable)c.Tweenable.prototype.filter.color=
{tweenCreated:function(a,d,c){b(a);b(d);b(c)},beforeTween:function(a,b,c){f=i(b);l(a,f);l(b,f);l(c,f)},afterTween:function(a,b,c){k(a,f);k(b,f);k(c,f)}}})(this);
(function(c){function a(a){var b;b={};c.Tweenable.util.each(a,function(a,c){typeof a[c]==="string"&&l.test(a[c])&&(b[c]={suffix:a[c].match(l)[0]})});return b}function b(a,b){c.Tweenable.util.each(b,function(b,c){a[c]=+a[c].replace(k,"")})}function i(a,b){c.Tweenable.util.each(b,function(b,c){a[c]+=b[c].suffix})}var l=/(px|em|%|pc|pt|mm|cm|in|ex)/i,k=/([a-z]|%)/gi,j;c.Tweenable.prototype.filter.token={beforeTween:function(c,i,f){j=a(i);b(c,j);b(i,j);b(f,j)},afterTween:function(a,b,c){i(a,j);i(b,j);
i(c,j)}}})(this);
(function(c){if(c.Tweenable)c.Tweenable.util.interpolate=function(a,b,i,l){var k;if(a&&a.from)b=a.to,i=a.position,l=a.easing,a=a.from;k=c.Tweenable.util.simpleCopy({},a);c.Tweenable.util.applyFilter("tweenCreated",k,[k,a,b]);c.Tweenable.util.applyFilter("beforeTween",k,[k,a,b]);i=c.Tweenable.util.tweenProps(i,{originalState:a,to:b,timestamp:0,duration:1,easingFunc:c.Tweenable.prototype.formula[l]||c.Tweenable.prototype.formula.linear},{current:k});c.Tweenable.util.applyFilter("afterTween",i,[i,a,
b]);return i},c.Tweenable.prototype.interpolate=function(a,b,i){a=c.Tweenable.util.interpolate(this.get(),a,b,i);this.set(a);return a}})(this);
