/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com
  v0.1.0

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/tweeny/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(a){function c(){return+new Date}function b(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a,c)}function d(a,c){b(c,function(c,b){a[b]=c[b]});return a}function i(a,c,b){for(var d in b.current)b.current.hasOwnProperty(d)&&c.to.hasOwnProperty(d)&&(b.current[d]=c.easingFunc(a-c.timestamp,c.originalState[d],c.to[d]-c.originalState[d],c.duration))}function f(a,c,b,d){var k;for(k=0;k<c[a].length;k++)c[a][k].apply(b,d)}function g(c,d,l){b(a.Tweenable.prototype.filter,function(a,b){a[b][c]&&a[b][c].apply(d,
l)})}function h(a,b){var d;d=c();d<a.timestamp+a.duration&&b.isAnimating?(g("beforeTween",a.owner,[b.current,a.originalState,a.to]),i(d,a,b),g("afterTween",a.owner,[b.current,a.originalState,a.to]),a.hook.step&&f("step",a.hook,a.owner,[b.current]),a.step.call(b.current),b.loopId=setTimeout(function(){h(a,b)},1E3/a.fps)):a.owner.stop(!0)}function e(){this.init=function(a){a=a||{};this._hook={};this._tweenParams={owner:this,hook:this._hook};this._state={};this._state.current=a.initialState||{};this.fps=
a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this};this.tween=function(a,b,l,m,k){var e=this;if(!this._state.isAnimating)return this._state.loopId=0,this._state.pausedAtTime=null,b?(this._tweenParams.step=function(){},this._state.current=a||{},this._tweenParams.to=b||{},this._tweenParams.duration=l||this.duration,this._tweenParams.callback=m||function(){},this._tweenParams.easing=k||this.easing):(this._tweenParams.step=a.step||function(){},this._tweenParams.callback=
a.callback||function(){},this._state.current=a.from||{},this._tweenParams.to=a.to||{},this._tweenParams.duration=a.duration||this.duration,this._tweenParams.easing=a.easing||this.easing),this._tweenParams.timestamp=c(),this._tweenParams.easingFunc=this.formula[this._tweenParams.easing]||this.formula.linear,g("tweenCreated",this._tweenParams.owner,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.originalState=d({},this._state.current),this._state.isAnimating=
!0,setTimeout(function(){h(e._tweenParams,e._state)},1E3/this.fps),this};this.get=function(){return this._state.current};this.stop=function(a){clearTimeout(this._state.loopId);this._state.isAnimating=!1;a&&(d(this._state.current,this._tweenParams.to),this._tweenParams.callback.call(this._state.current));return this};this.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=c();this._state.isPaused=!0;return this};this.resume=function(){var a=this;this._state.isPaused&&(this._tweenParams.timestamp+=
this._state.pausedAtTime-this._tweenParams.timestamp);setTimeout(function(){h(a._tweenParams,a._state)},1E3/this.fps);return this};this.hookAdd=function(a,b){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(b)};this.hookRemove=function(a,b){var c;if(this._hook.hasOwnProperty(a))if(b)for(c=this._hook[a].length;c>=0;c++)this._hook[a][c]===b&&this._hook[a].splice(c,1);else this._hook[a]=[]};return this}e.prototype.filter={};e.util={now:c,each:b,simpleCopy:d};e.prototype.formula={linear:function(a,
b,c,d){return c*a/d+b}};a.Tweenable=e})(this);Tweenable.prototype.formula.easeInQuad=function(a,c,b,d){a/=d;return b*a*a+c};Tweenable.prototype.formula.easeOutQuad=function(a,c,b,d){a/=d;return-b*a*(a-2)+c};Tweenable.prototype.formula.easeInOutQuad=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a+c;a--;return-b/2*(a*(a-2)-1)+c};Tweenable.prototype.formula.easeInCubic=function(a,c,b,d){a/=d;return b*a*a*a+c};Tweenable.prototype.formula.easeOutCubic=function(a,c,b,d){a/=d;a--;return b*(a*a*a+1)+c};
Tweenable.prototype.formula.easeInOutCubic=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a*a+c;a-=2;return b/2*(a*a*a+2)+c};Tweenable.prototype.formula.easeInQuart=function(a,c,b,d){a/=d;return b*a*a*a*a+c};Tweenable.prototype.formula.easeOutQuart=function(a,c,b,d){a/=d;a--;return-b*(a*a*a*a-1)+c};Tweenable.prototype.formula.easeInOutQuart=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a*a*a+c;a-=2;return-b/2*(a*a*a*a-2)+c};
Tweenable.prototype.formula.easeInQuint=function(a,c,b,d){a/=d;return b*a*a*a*a*a+c};Tweenable.prototype.formula.easeOutQuint=function(a,c,b,d){a/=d;a--;return b*(a*a*a*a*a+1)+c};Tweenable.prototype.formula.easeInOutQuint=function(a,c,b,d){a/=d/2;if(a<1)return b/2*a*a*a*a*a+c;a-=2;return b/2*(a*a*a*a*a+2)+c};Tweenable.prototype.formula.easeInSine=function(a,c,b,d){return-b*Math.cos(a/d*(Math.PI/2))+b+c};Tweenable.prototype.formula.easeOutSine=function(a,c,b,d){return b*Math.sin(a/d*(Math.PI/2))+c};
Tweenable.prototype.formula.easeInOutSine=function(a,c,b,d){return-b/2*(Math.cos(Math.PI*a/d)-1)+c};Tweenable.prototype.formula.easeInExpo=function(a,c,b,d){return b*Math.pow(2,10*(a/d-1))+c};Tweenable.prototype.formula.easeOutExpo=function(a,c,b,d){return b*(-Math.pow(2,-10*a/d)+1)+c};Tweenable.prototype.formula.easeInOutExpo=function(a,c,b,d){a/=d/2;if(a<1)return b/2*Math.pow(2,10*(a-1))+c;a--;return b/2*(-Math.pow(2,-10*a)+2)+c};
Tweenable.prototype.formula.easeInCirc=function(a,c,b,d){a/=d;return-b*(Math.sqrt(1-a*a)-1)+c};Tweenable.prototype.formula.easeOutCirc=function(a,c,b,d){a/=d;a--;return b*Math.sqrt(1-a*a)+c};Tweenable.prototype.formula.easeInOutCirc=function(a,c,b,d){a/=d/2;if(a<1)return-b/2*(Math.sqrt(1-a*a)-1)+c;a-=2;return b/2*(Math.sqrt(1-a*a)+1)+c};
(function(a){function c(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function b(a,b,c,g,h,e){return function(){c?a.tween(b,c,g,h,e):(b.callback=h,a.tween(b))}}if(a.Tweenable)a.Tweenable.prototype.queue=function(a,i,f,g,h){if(!this._tweenQueue)this._tweenQueue=[];g=g||a.callback||function(){};g=c(g,this._tweenQueue);this._tweenQueue.push(b(this,a,i,f,g,h));if(!this._tweenQueue.running)this._tweenQueue[0](),this._tweenQueue.running=!0;return this},a.Tweenable.prototype.queueShift=
function(){this._tweenQueue.shift();return this},a.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this},a.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this},a.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(a){function c(a){return parseInt(a,16)}function b(b){a.Tweenable.util.each(b,function(a,b){if(typeof a[b]==="string"&&(g.test(a[b])||h.test(a[b]))){var d;d=a[b];d=d.replace(/#/g,"");d.length===3&&(d=d.split(""),d=d[0]+d[0]+d[1]+d[1]+d[2]+d[2]);d=[c(d.substr(0,2)),c(d.substr(2,2)),c(d.substr(4,2))];a[b]="rgb("+d[0]+","+d[1]+","+d[2]+")"}})}function d(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&(g.test(a[b])||h.test(a[b])||e.test(a[b]))&&c.push(b)});return c}
function i(a,b){var c,d,e;d=b.length;for(c=0;c<d;c++)e=a[b[c]].match(/(\d+)/g),a["__r__"+b[c]]=+e[0],a["__g__"+b[c]]=+e[1],a["__b__"+b[c]]=+e[2],delete a[b[c]]}function f(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var g=/^#([0-9]|[a-f]){3}$/i,h=/^#([0-9]|[a-f]){6}$/i,e=/^rgb\(\d+\s*,\d+\s*,\d+\s*\)\s*$/i,j;if(a.Tweenable)a.Tweenable.prototype.filter.color=
{tweenCreated:function(a,c,d){b(a);b(c);b(d)},beforeTween:function(a,b,c){j=d(b);i(a,j);i(b,j);i(c,j)},afterTween:function(a,b,c){f(a,j);f(b,j);f(c,j)}}})(this);
(function(a){function c(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&i.test(a[b])&&c.push(b)});return c}function b(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=+a[b[c]].replace(i,"")}function d(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=Math.floor(a[b[c]])+"px"}var i=/px/i,f;if(a.Tweenable)a.Tweenable.prototype.filter.px={beforeTween:function(a,d,e){f=c(d);b(a,f);b(d,f);b(e,f)},afterTween:function(a,b,c){d(a,f);d(b,f);d(c,f)}}})(this);
