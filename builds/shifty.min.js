/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com
  v0.1.0

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/tweeny/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(a){function d(){return+new Date}function b(a,e){for(var l in a)a.hasOwnProperty(l)&&e(a,l)}function c(a,e){b(e,function(e,b){a[b]=e[b]});return a}function j(a,e){b(e,function(e,b){typeof a[b]==="undefined"&&(a[b]=e[b])});return a}function g(a,e,b){for(var d in b.current)b.current.hasOwnProperty(d)&&e.to.hasOwnProperty(d)&&(b.current[d]=e.easingFunc(a-e.timestamp,e.originalState[d],e.to[d]-e.originalState[d],e.duration))}function i(a,e,b,d){var c;for(c=0;c<e[a].length;c++)e[a][c].apply(b,
d)}function f(m,e,d){b(a.Tweenable.prototype.filter,function(a,b){a[b][m]&&a[b][m].apply(e,d)})}function k(a,b){var c;c=d();c<a.timestamp+a.duration&&b.isAnimating?(f("beforeTween",a.owner,[b.current,a.originalState,a.to]),g(c,a,b),f("afterTween",a.owner,[b.current,a.originalState,a.to]),a.hook.step&&i("step",a.hook,a.owner,[b.current]),a.step.call(b.current),b.loopId=setTimeout(function(){k(a,b)},1E3/a.fps)):a.owner.stop(!0)}function h(){this.init=function(a){a=a||{};this._hook={};this._tweenParams=
{owner:this,hook:this._hook};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this};this.tween=function(a,b,l,n,i){var h=this;if(!this._state.isAnimating)return this._state.loopId=0,this._state.pausedAtTime=null,b?(this._tweenParams.step=function(){},this._state.current=a||{},this._tweenParams.to=b||{},this._tweenParams.duration=l||this.duration,this._tweenParams.callback=n||function(){},this._tweenParams.easing=
i||this.easing):(this._tweenParams.step=a.step||function(){},this._tweenParams.callback=a.callback||function(){},this._state.current=a.from||{},this._tweenParams.to=a.to||a.target||{},this._tweenParams.duration=a.duration||this.duration,this._tweenParams.easing=a.easing||this.easing),this._tweenParams.timestamp=d(),this._tweenParams.easingFunc=this.formula[this._tweenParams.easing]||this.formula.linear,j(this._state.current,this._tweenParams.to),j(this._tweenParams.to,this._state.current),f("tweenCreated",
this._tweenParams.owner,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.originalState=c({},this._state.current),this._state.isAnimating=!0,setTimeout(function(){k(h._tweenParams,h._state)},1E3/this.fps),this};this.to=function(a,b,d,c){typeof b==="undefined"?(a.from=this._state.current,this.tween(a)):this.tween(this._state.current,a,b,d,c);return this};this.get=function(){return this._state.current};this.stop=function(a){clearTimeout(this._state.loopId);
this._state.isAnimating=!1;a&&(c(this._state.current,this._tweenParams.to),this._tweenParams.callback.call(this._state.current));return this};this.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=d();this._state.isPaused=!0;return this};this.resume=function(){var a=this;this._state.isPaused&&(this._tweenParams.timestamp+=this._state.pausedAtTime-this._tweenParams.timestamp);setTimeout(function(){k(a._tweenParams,a._state)},1E3/this.fps);return this};this.hookAdd=function(a,
b){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(b)};this.hookRemove=function(a,b){var d;if(this._hook.hasOwnProperty(a))if(b)for(d=this._hook[a].length;d>=0;d++)this._hook[a][d]===b&&this._hook[a].splice(d,1);else this._hook[a]=[]};return this}h.prototype.filter={};h.util={now:d,each:b,simpleCopy:c};h.prototype.formula={linear:function(a,b,d,c){return d*a/c+b}};a.Tweenable=h})(this);Tweenable.prototype.formula.easeInQuad=function(a,d,b,c){a/=c;return b*a*a+d};
Tweenable.prototype.formula.easeOutQuad=function(a,d,b,c){a/=c;return-b*a*(a-2)+d};Tweenable.prototype.formula.easeInOutQuad=function(a,d,b,c){a/=c/2;if(a<1)return b/2*a*a+d;a--;return-b/2*(a*(a-2)-1)+d};Tweenable.prototype.formula.easeInCubic=function(a,d,b,c){a/=c;return b*a*a*a+d};Tweenable.prototype.formula.easeOutCubic=function(a,d,b,c){a/=c;a--;return b*(a*a*a+1)+d};Tweenable.prototype.formula.easeInOutCubic=function(a,d,b,c){a/=c/2;if(a<1)return b/2*a*a*a+d;a-=2;return b/2*(a*a*a+2)+d};
Tweenable.prototype.formula.easeInQuart=function(a,d,b,c){a/=c;return b*a*a*a*a+d};Tweenable.prototype.formula.easeOutQuart=function(a,d,b,c){a/=c;a--;return-b*(a*a*a*a-1)+d};Tweenable.prototype.formula.easeInOutQuart=function(a,d,b,c){a/=c/2;if(a<1)return b/2*a*a*a*a+d;a-=2;return-b/2*(a*a*a*a-2)+d};Tweenable.prototype.formula.easeInQuint=function(a,d,b,c){a/=c;return b*a*a*a*a*a+d};Tweenable.prototype.formula.easeOutQuint=function(a,d,b,c){a/=c;a--;return b*(a*a*a*a*a+1)+d};
Tweenable.prototype.formula.easeInOutQuint=function(a,d,b,c){a/=c/2;if(a<1)return b/2*a*a*a*a*a+d;a-=2;return b/2*(a*a*a*a*a+2)+d};Tweenable.prototype.formula.easeInSine=function(a,d,b,c){return-b*Math.cos(a/c*(Math.PI/2))+b+d};Tweenable.prototype.formula.easeOutSine=function(a,d,b,c){return b*Math.sin(a/c*(Math.PI/2))+d};Tweenable.prototype.formula.easeInOutSine=function(a,d,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+d};
Tweenable.prototype.formula.easeInExpo=function(a,d,b,c){return b*Math.pow(2,10*(a/c-1))+d};Tweenable.prototype.formula.easeOutExpo=function(a,d,b,c){return b*(-Math.pow(2,-10*a/c)+1)+d};Tweenable.prototype.formula.easeInOutExpo=function(a,d,b,c){a/=c/2;if(a<1)return b/2*Math.pow(2,10*(a-1))+d;a--;return b/2*(-Math.pow(2,-10*a)+2)+d};Tweenable.prototype.formula.easeInCirc=function(a,d,b,c){a/=c;return-b*(Math.sqrt(1-a*a)-1)+d};
Tweenable.prototype.formula.easeOutCirc=function(a,d,b,c){a/=c;a--;return b*Math.sqrt(1-a*a)+d};Tweenable.prototype.formula.easeInOutCirc=function(a,d,b,c){a/=c/2;if(a<1)return-b/2*(Math.sqrt(1-a*a)-1)+d;a-=2;return b/2*(Math.sqrt(1-a*a)+1)+d};
(function(a){function d(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function b(a,b,d,i,f,k){return function(){d?a.tween(b,d,i,f,k):(b.callback=f,b.from?a.tween(b):a.to(b))}}if(a.Tweenable)a.Tweenable.prototype.queue=function(a,j,g,i,f){if(!this._tweenQueue)this._tweenQueue=[];i=i||a.callback||function(){};i=d(i,this._tweenQueue);this._tweenQueue.push(b(this,a,j,g,i,f));if(!this._tweenQueue.running)this._tweenQueue[0](),this._tweenQueue.running=!0;return this},a.Tweenable.prototype.queueShift=
function(){this._tweenQueue.shift();return this},a.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this},a.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this},a.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(a){function d(a){return parseInt(a,16)}function b(b){a.Tweenable.util.each(b,function(a,b){if(typeof a[b]==="string"&&(i.test(a[b])||f.test(a[b]))){var c;c=a[b];c=c.replace(/#/g,"");c.length===3&&(c=c.split(""),c=c[0]+c[0]+c[1]+c[1]+c[2]+c[2]);c=[d(c.substr(0,2)),d(c.substr(2,2)),d(c.substr(4,2))];a[b]="rgb("+c[0]+","+c[1]+","+c[2]+")"}})}function c(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&(i.test(a[b])||f.test(a[b])||k.test(a[b]))&&c.push(b)});return c}
function j(a,b){var c,d,f;d=b.length;for(c=0;c<d;c++)f=a[b[c]].match(/(\d+)/g),a["__r__"+b[c]]=+f[0],a["__g__"+b[c]]=+f[1],a["__b__"+b[c]]=+f[2],delete a[b[c]]}function g(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var i=/^#([0-9]|[a-f]){3}$/i,f=/^#([0-9]|[a-f]){6}$/i,k=/^rgb\(\d+\s*,\d+\s*,\d+\s*\)\s*$/i,h;if(a.Tweenable)a.Tweenable.prototype.filter.color=
{tweenCreated:function(a,c,d){b(a);b(c);b(d)},beforeTween:function(a,b,d){h=c(b);j(a,h);j(b,h);j(d,h)},afterTween:function(a,b,c){g(a,h);g(b,h);g(c,h)}}})(this);
(function(a){function d(b){var c;c=[];a.Tweenable.util.each(b,function(a,b){typeof a[b]==="string"&&j.test(a[b])&&c.push(b)});return c}function b(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=+a[b[c]].replace(j,"")}function c(a,b){var c,d;d=b.length;for(c=0;c<d;c++)a[b[c]]=Math.floor(a[b[c]])+"px"}var j=/px/i,g;if(a.Tweenable)a.Tweenable.prototype.filter.px={beforeTween:function(a,c,j){g=d(c);b(a,g);b(c,g);b(j,g)},afterTween:function(a,b,d){c(a,g);c(b,g);c(d,g)}}})(this);
