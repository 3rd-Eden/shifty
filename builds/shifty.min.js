/**
Shifty - A teeny tiny tweening engine in JavaScript. 
By Jeremy Kahn - jeremyckahn@gmail.com

  v0.4.9

For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/shifty/blob/master/README.md

MIT Lincense.  This code free to use, modify, distribute and enjoy.

*/

(function(b){function a(){return+new Date}function f(a,c){for(var n in a)a.hasOwnProperty(n)&&c(a,n)}function h(a,c){f(c,function(c,d){a[d]=c[d]});return a}function k(a,c){f(c,function(c,d){typeof a[d]==="undefined"&&(a[d]=c[d])});return a}function j(a,c,n){var d,a=(a-c.timestamp)/c.duration;for(d in n.current)n.current.hasOwnProperty(d)&&c.to.hasOwnProperty(d)&&(n.current[d]=e(c.originalState[d],c.to[d],c.easingFunc,a));return n.current}function e(a,c,d,b){return a+(c-a)*d(b)}function l(a,c,d,b){var f;
for(f=0;f<c[a].length;f++)c[a][f].apply(d,b)}function m(a,c,d){f(b.Tweenable.prototype.filter,function(b,f){b[f][a]&&b[f][a].apply(c,d)})}function i(g,c){var d;d=a();d<g.timestamp+g.duration&&c.isTweening?(c.loopId=setTimeout(function(){i(g,c)},1E3/g.owner.fps),m("beforeTween",g.owner,[c.current,g.originalState,g.to]),j(d,g,c),m("afterTween",g.owner,[c.current,g.originalState,g.to]),g.hook.step&&l("step",g.hook,g.owner,[c.current]),g.step.call(c.current)):g.owner.stop(true)}function d(a){a=a||{};
this._hook={};this._tweenParams={owner:this,hook:this._hook,data:{}};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||"linear";this.duration=a.duration||500;return this}d.prototype.tween=function(g,c,d,b,f){var e,i;if(!this._state.isTweening)return e=this._tweenParams,i=this._state,this._state.loopId=0,this._state.pausedAtTime=null,c?(e.step=function(){},e.to=c||{},e.duration=d||this.duration,e.callback=b||function(){},e.easing=f||this.easing,i.current=
g||{}):(e.step=g.step||function(){},e.callback=g.callback||function(){},e.to=g.to||g.target||{},e.duration=g.duration||this.duration,e.easing=g.easing||this.easing,i.current=g.from||{}),e.timestamp=a(),e.easingFunc=this.formula[e.easing]||this.formula.linear,k(i.current,e.to),k(e.to,i.current),m("tweenCreated",e.owner,[i.current,e.originalState,e.to]),e.originalState=h({},i.current),i.isTweening=true,this.resume(),g.start&&g.start(),this};d.prototype.to=function(a,c,d,b){typeof c==="undefined"?(a.from=
this.get(),this.tween(a)):this.tween(this.get(),a,c,d,b);return this};d.prototype.get=function(){return this._state.current};d.prototype.set=function(a){this._state.current=a||{};return this};d.prototype.stop=function(a){clearTimeout(this._state.loopId);this._state.isTweening=false;a&&(h(this._state.current,this._tweenParams.to),m("afterTweenEnd",this,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.callback.call(this._state.current));return this};d.prototype.pause=
function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=a();this._state.isPaused=true;return this};d.prototype.resume=function(){this._state.isPaused&&(this._tweenParams.timestamp+=a()-this._state.pausedAtTime);i(this._tweenParams,this._state);return this};d.prototype.hookAdd=function(a,c){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(c)};d.prototype.hookRemove=function(a,c){var d;if(this._hook.hasOwnProperty(a))if(c)for(d=this._hook[a].length;d>=0;d++)this._hook[a][d]===
c&&this._hook[a].splice(d,1);else this._hook[a]=[]};d.prototype.filter={};d.util={now:a,each:f,tweenProps:j,tweenProp:e,applyFilter:m,simpleCopy:h,weakCopy:k};d.prototype.formula={linear:function(a){return a}};if(typeof b.Tweenable==="undefined")b.Tweenable=d})(this);
(function(b){b.Tweenable.util.simpleCopy(b.Tweenable.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=0.5)<1?0.5*Math.pow(a,2):-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=0.5)<1?0.5*Math.pow(a,3):0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){return(a/=0.5)<1?0.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=0.5)<1?0.5*Math.pow(a,5):0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==0?0:Math.pow(2,
10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return a==0?0:a==1?1:(a/=0.5)<1?0.5*Math.pow(2,10*(a-1)):0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=0.5)<1?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*
(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;return(a/=0.5)<1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},
swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*a+0.984375)},easeFromTo:function(a){return(a/=0.5)<1?0.5*Math.pow(a,
4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}})})(this);
(function(b){function a(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=false}}function f(a,b,f,e,l,m){return function(){f?a.tween(b,f,e,l,m):(b.callback=l,b.from?a.tween(b):a.to(b))}}b.Tweenable.prototype.queue=function(b,k,j,e,l){if(!this._tweenQueue)this._tweenQueue=[];e=e||b.callback||function(){};e=a(e,this._tweenQueue);this._tweenQueue.push(f(this,b,k,j,e,l));return this};b.Tweenable.prototype.queueStart=function(){if(!this._tweenQueue.running&&this._tweenQueue.length>
0)this._tweenQueue[0](),this._tweenQueue.running=true;return this};b.Tweenable.prototype.queueShift=function(){this._tweenQueue.shift();return this};b.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this};b.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};b.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(b){function a(a){return parseInt(a,16)}function f(d){b.Tweenable.util.each(d,function(d,c){if(typeof d[c]==="string"&&(e.test(d[c])||l.test(d[c]))){var b;b=d[c];b=b.replace(/#/g,"");b.length===3&&(b=b.split(""),b=b[0]+b[0]+b[1]+b[1]+b[2]+b[2]);b=[a(b.substr(0,2)),a(b.substr(2,2)),a(b.substr(4,2))];d[c]="rgb("+b[0]+","+b[1]+","+b[2]+")"}})}function h(a){var g;g=[];b.Tweenable.util.each(a,function(a,b){typeof a[b]==="string"&&(e.test(a[b])||l.test(a[b])||m.test(a[b]))&&g.push(b)});return g}
function k(a,b){var c,e,f;e=b.length;for(c=0;c<e;c++)f=a[b[c]].match(/(\d+)/g),a["__r__"+b[c]]=+f[0],a["__g__"+b[c]]=+f[1],a["__b__"+b[c]]=+f[2],delete a[b[c]]}function j(a,b){var c,e;e=b.length;for(c=0;c<e;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var e=/^#([0-9]|[a-f]){3}$/i,l=/^#([0-9]|[a-f]){6}$/i,m=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,i;if(b.Tweenable)b.Tweenable.prototype.filter.color=
{tweenCreated:function(a,b,c){f(a);f(b);f(c)},beforeTween:function(a,b,c){i=h(b);k(a,i);k(b,i);k(c,i)},afterTween:function(a,b,c){j(a,i);j(b,i);j(c,i)}}})(this);
(function(b){function a(a){var e;e={};b.Tweenable.util.each(a,function(a,b){typeof a[b]==="string"&&k.test(a[b])&&(e[b]={suffix:a[b].match(k)[0]})});return e}function f(a,e){b.Tweenable.util.each(e,function(b,d){a[d]=+a[d].replace(j,"")})}function h(a,e){b.Tweenable.util.each(e,function(b,d){a[d]+=b[d].suffix})}var k=/(px|em|%|pc|pt|mm|cm|in|ex)/i,j=/([a-z]|%)/gi,e;b.Tweenable.prototype.filter.token={beforeTween:function(b,h,i){e=a(h);f(b,e);f(h,e);f(i,e)},afterTween:function(a,b,f){h(a,e);h(b,e);
h(f,e)}}})(this);
(function(b){if(b.Tweenable)b.Tweenable.util.interpolate=function(a,f,h,k){var j;if(a&&a.from)f=a.to,h=a.position,k=a.easing,a=a.from;j=b.Tweenable.util.simpleCopy({},a);b.Tweenable.util.applyFilter("tweenCreated",j,[j,a,f]);b.Tweenable.util.applyFilter("beforeTween",j,[j,a,f]);h=b.Tweenable.util.tweenProps(h,{originalState:a,to:f,timestamp:0,duration:1,easingFunc:b.Tweenable.prototype.formula[k]||b.Tweenable.prototype.formula.linear},{current:j});b.Tweenable.util.applyFilter("afterTween",h,[h,a,
f]);return h},b.Tweenable.prototype.interpolate=function(a,f,h){a=b.Tweenable.util.interpolate(this.get(),a,f,h);this.set(a);return a}})(this);
