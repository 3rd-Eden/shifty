/*

 Shifty <http://jeremyckahn.github.com/shifty/>
 Author: Jeremy Kahn - jeremyckahn@gmail.com
 License: MIT
 Version: 0.5.0+ (Mon, 26 Dec 2011 15:01:53 GMT)
*/
(function(){var b;(function(a){function h(a,c){for(var g in a)a.hasOwnProperty(g)&&c(a,g)}function k(a,c){h(c,function(c,g){a[g]=c[g]});return a}function i(a,c){h(c,function(c,g){"undefined"===typeof a[g]&&(a[g]=c[g])});return a}function e(a,c,g){var d,a=(a-c.timestamp)/c.duration;for(d in g.current)g.current.hasOwnProperty(d)&&c.to.hasOwnProperty(d)&&(g.current[d]=j(c.originalState[d],c.to[d],n[c.easing[d]],a));return g.current}function j(a,c,g,d){return a+(c-a)*g(d)}function f(a,c,g,d){var b;for(b=
0;b<c[a].length;b++)c[a][b].apply(g,d)}function l(a,c,g){h(b.prototype.filter,function(d,b){d[b][a]&&d[b][a].apply(c,g)})}function m(a,c){var d=a.timestamp+a.duration,b=Math.min(g(),d),d=b>=d;if(c.isTweening){if(!d)c.loopId=setTimeout(function(){m(a,c)},1E3/a.owner.fps);l("beforeTween",a.owner,[c.current,a.originalState,a.to]);e(b,a,c);l("afterTween",a.owner,[c.current,a.originalState,a.to]);a.hook.step&&f("step",a.hook,a.owner,[c.current]);a.step&&a.step.call(c.current)}(d||!c.isTweening)&&a.owner.stop(!0)}
function d(a,g){var d;d={};"string"===typeof g?h(a,function(a,c){d[c]=g}):h(a,function(a,b){d[b]||(d[b]=g[b]||c)});return d}var g,c="linear",n;g="function"===typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:function(){return+new Date};if(SHIFTY_DEBUG_NOW)a.timeoutHandler=m;b=function(a){a=a||{};this._hook={};this._tweenParams={owner:this,hook:this._hook,data:{}};this._state={};this._state.current=a.initialState||{};this.fps=a.fps||30;this.easing=a.easing||c;this.duration=a.duration||500;return this};b.prototype.tween=
function(a,c,b,n,h){var e,f;if(!this._state.isTweening)return e=this._tweenParams,f=this._state,this._state.loopId=0,this._state.pausedAtTime=null,c?(e.to=c||{},e.duration=b||this.duration,e.callback=n,e.easing=h||this.easing,f.current=a||{}):(e.step=a.step,e.callback=a.callback,e.to=a.to||a.target||{},e.duration=a.duration||this.duration,e.easing=a.easing||this.easing,f.current=a.from||{}),e.timestamp=g(),i(f.current,e.to),i(e.to,f.current),e.easing=d(f.current,e.easing),l("tweenCreated",e.owner,
[f.current,e.originalState,e.to]),e.originalState=k({},f.current),f.isTweening=!0,this.resume(),a.start&&a.start(),this};b.prototype.to=function(a,c,d,g){1===arguments.length?"to"in a?(a.from=this.get(),this.tween(a)):this.tween(this.get(),a):this.tween(this.get(),a,c,d,g);return this};b.prototype.get=function(){return this._state.current};b.prototype.set=function(a){this._state.current=a||{};return this};b.prototype.stop=function(a){clearTimeout(this._state.loopId);this._state.isTweening=!1;a&&(k(this._state.current,
this._tweenParams.to),l("afterTweenEnd",this,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.callback&&this._tweenParams.callback.call(this._state.current));return this};b.prototype.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=g();this._state.isPaused=!0;return this};b.prototype.resume=function(){this._state.isPaused&&(this._tweenParams.timestamp+=g()-this._state.pausedAtTime);m(this._tweenParams,this._state);return this};
b.prototype.hookAdd=function(a,c){this._hook.hasOwnProperty(a)||(this._hook[a]=[]);this._hook[a].push(c)};b.prototype.hookRemove=function(a,c){var d;if(this._hook.hasOwnProperty(a))if(c)for(d=this._hook[a].length;0<=d;d++)this._hook[a][d]===c&&this._hook[a].splice(d,1);else this._hook[a]=[]};b.prototype.filter={};b.util={now:g,each:h,tweenProps:e,tweenProp:j,applyFilter:l,simpleCopy:k,weakCopy:i,composeEasingObject:d};n=b.prototype.formula={linear:function(a){return a}};if("object"===typeof exports)module.exports=
b;else if("function"===typeof define&&define.amd)define(function(){return b});else if("undefined"===typeof a.Tweenable)a.Tweenable=b})(this);(function(){b.util.simpleCopy(b.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return 1>(a/=0.5)?0.5*Math.pow(a,2):-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return 1>
(a/=0.5)?0.5*Math.pow(a,3):0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){return 1>(a/=0.5)?0.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return 1>(a/=0.5)?0.5*Math.pow(a,5):0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*
(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return 0==a?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return 1==a?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return 0==a?0:1==a?1:1>(a/=0.5)?0.5*Math.pow(2,10*(a-1)):0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return 1>(a/=0.5)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-
(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;return 1>(a/=0.5)?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((6*a-1)*2*Math.PI/2)+1},
swingFromTo:function(a){var b=1.70158;return 1>(a/=0.5)?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*
(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*a+0.984375)},easeFromTo:function(a){return 1>(a/=0.5)?0.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}})})();(function(){function a(a,b){return function(){a();b.shift();if(b.length)b[0]();else b.running=!1}}function h(a,b,h,f,l,m){return function(){h?a.tween(b,h,f,l,m):(b.callback=l,b.from?a.tween(b):a.to(b))}}var k=function(){};b.prototype.queue=function(b,e,j,
f,l){if(!this._tweenQueue)this._tweenQueue=[];f=f||b.callback||k;f=a(f,this._tweenQueue);this._tweenQueue.push(h(this,b,e,j,f,l));return this};b.prototype.queueStart=function(){if(!this._tweenQueue.running&&0<this._tweenQueue.length)this._tweenQueue[0](),this._tweenQueue.running=!0;return this};b.prototype.queueShift=function(){this._tweenQueue.shift();return this};b.prototype.queuePop=function(){this._tweenQueue.pop();return this};b.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};
b.prototype.queueLength=function(){return this._tweenQueue.length}})();(function(){function a(a){return parseInt(a,16)}function h(d){b.util.each(d,function(b,c){if("string"===typeof b[c]&&(j.test(b[c])||f.test(b[c]))){var d;d=b[c];d=d.replace(/#/g,"");3===d.length&&(d=d.split(""),d=d[0]+d[0]+d[1]+d[1]+d[2]+d[2]);d=[a(d.substr(0,2)),a(d.substr(2,2)),a(d.substr(4,2))];b[c]="rgb("+d[0]+","+d[1]+","+d[2]+")"}})}function k(a){var g;g=[];b.util.each(a,function(a,d){"string"===typeof a[d]&&(j.test(a[d])||
f.test(a[d])||l.test(a[d]))&&g.push(d)});return g}function i(a,b){var c,e,f;e=b.length;for(c=0;c<e;c++)f=a[b[c]].match(/(\d+)/g),a["__r__"+b[c]]=+f[0],a["__g__"+b[c]]=+f[1],a["__b__"+b[c]]=+f[2],delete a[b[c]]}function e(a,b){var c,f;f=b.length;for(c=0;c<f;c++)a[b[c]]="rgb("+parseInt(a["__r__"+b[c]],10)+","+parseInt(a["__g__"+b[c]],10)+","+parseInt(a["__b__"+b[c]],10)+")",delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}var j=/^#([0-9]|[a-f]){3}$/i,f=/^#([0-9]|[a-f]){6}$/i,l=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,
m;if(b)b.prototype.filter.color={tweenCreated:function(a,b,c){h(a);h(b);h(c)},beforeTween:function(a,b,c){m=k(b);i(a,m);i(b,m);i(c,m);var a=this._tweenParams.easing,b=m,f;f=b.length;for(c=0;c<f;c++)a["__r__"+b[c]]=a[b[c]],a["__g__"+b[c]]=a[b[c]],a["__b__"+b[c]]=a[b[c]]},afterTween:function(a,b,c){e(a,m);e(b,m);e(c,m);var a=this._tweenParams.easing,b=m,f;f=b.length;for(c=0;c<f;c++)delete a["__r__"+b[c]],delete a["__g__"+b[c]],delete a["__b__"+b[c]]}}})();(function(){function a(a){var e;e={};b.util.each(a,
function(a,b){"string"===typeof a[b]&&i.test(a[b])&&(e[b]={suffix:a[b].match(i)[0]})});return e}function h(a,h){b.util.each(h,function(b,d){a[d]=+a[d].replace(e,"")})}function k(a,e){b.util.each(e,function(b,d){a[d]+=b[d].suffix})}var i=/(px|em|%|pc|pt|mm|cm|in|ex)/i,e=/([a-z]|%)/gi,j;b.prototype.filter.token={beforeTween:function(b,e,i){j=a(e);h(b,j);h(e,j);h(i,j)},afterTween:function(a,b,e){k(a,j);k(b,j);k(e,j)}}})();(function(){if(b)b.util.interpolate=function(a,h,k,i){var e;if(a&&a.from)h=a.to,
k=a.position,i=a.easing,a=a.from;e=new b;e._tweenParams.easing=i;i=b.util.simpleCopy({},a);b.util.applyFilter("tweenCreated",e,[i,a,h]);b.util.applyFilter("beforeTween",e,[i,a,h]);var j=a,f=h,l;l=b.util.composeEasingObject(j,e._tweenParams.easing);i=b.util.tweenProps(k,{originalState:j,to:f,timestamp:0,duration:1,easing:l},{current:i});b.util.applyFilter("afterTween",e,[i,a,h]);return i},b.prototype.interpolate=function(a,h,k){a=b.util.interpolate(this.get(),a,h,k);this.set(a);return a}})()})();
